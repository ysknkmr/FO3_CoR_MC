\section{Introduction}\label{sec: introduction}

\begin{hidden}
\begin{screen}
    (Background) % \Ja{（設定：1項関係と2項関係のみ、関数記号なし、定数記号なし、等号あり）}
    \begin{itemize}
        \item \Ja{$\fo^{k}$ モデル検査: in $\mathcal{O}(\len{\fml} \cdot n^{k})$ time (see, "eg", \cite[Proposition 3.1]{vardiComplexityBoundedvariableQueries1995})}
        \item \Ja{"Williams' algorithm": in $\mathcal{O}(2^{\len{\fml}} \cdot n^{\omega})$ time for $\fo^{3}$ \cite[Corollary 1.3]{williamsFasterDecisionFirstorder2014}\cite[Theorem 7]{gaoFineGrainedComplexityStrengthenings2019}.}\\
        ($\bigstar$: \Ja{$\mathcal{O}(2^{\len{\fml}} \cdot n^{k-3+\omega})$ time for $\fo^{k}$ は正しい？})
        \item \Ja{"CoR" モデル検査: in $\mathcal{O}(\len{\fml} \cdot n^{\omega})$ time.}
    \end{itemize}

    (Contribution)
    \begin{itemize}
        \item "Williams' algorithm" (for $\fo^{3}$ and for $\fo^{k}$ in "PNF") $\approx$ $\fo^{3}$-to-"CoR" translation.

        \item For $\fo^{k}$, for any $\eps > 0$, there is no algorithm in $\poly(\len{\fml}) \cdot n^{k - \eps}$ time, under "SETH".
        \begin{itemize}
            \item There is no polynomial-time translation from $\fo^{3}$ to "CoR", under "SETH".
        \end{itemize}

        \item $\poly(\len{\fml}) \cdot n^{3 - \eps}$ time algorithms for (parameterized) fragments of $\fo^{3}$.
        \begin{itemize}
            \item ``"quantifier-width"''
            \item A dichotomy "wrt" "signatures"
        \end{itemize}
    \end{itemize}
    \dots
    % (Future work)
    % \begin{itemize}
    %     \item Succinctness gap between $\fo^{3}$ and "CoR" still remains open.
    %     \item k-dimension matrix multiplication. 
    % \end{itemize}
\end{screen}
\end{hidden}

\begin{yoshiki}
    TODO: (Below is wip.)
\end{yoshiki}

\AP The ""model checking problem"" is the following problem:
\begin{center}
given both a "sentence" $\fml$ and a "structure" $\struc$, does $\struc \models \fml$ hold?
\end{center}
Unfortunately, the "model checking problem" for $\fo$ is complete in "PSPACE".
Nevertheless, when the number of "variables" is fixed, the "model checking problem" for $\fo^{k}$ can be decided in $\mathcal{O}(\len{\fml} \cdot n^{k})$ time by a naive bottom-up evaluation algorithm (see, "eg", \cite[Proposition 3.1]{vardiComplexityBoundedvariableQueries1995}),
where $\len{\fml}$ is the length of $\fml$ and $n$ is the number of \kl{vertices} in $\struc$.
A natural question is 
\begin{center}
    Can the complexity be improved from $\mathcal{O}(\len{\fml} \cdot n^{k})$ time?
\end{center}

Williams \cite{williamsFasterDecisionFirstorder2014} gave a positive answer to this question.
He showed that when $\fml$ is \emph{fixed}, the following holds:
\begin{itemize}
    \item
    For every $k \ge 3$, the "model checking problem" for $\fo^{k}$ \kl{sentences}%
    \footnote{Precisely, Williams \cite{williamsFasterDecisionFirstorder2014} shows for $\fo^{k}$ \kl{sentences} in \emph{"prenex normal form"} (so, the number of occurrences of "quantifiers" is at most $k$) \cite[Corollary 1.3]{williamsFasterDecisionFirstorder2014}.
    Later, Gao and Impagliazzo \cite[Theorem 7]{gaoFineGrainedComplexityStrengthenings2019} claims that Williams' algorithm can be extended for general $\fo^{k}$ \kl{sentences}.
    \begin{yoshiki}
    (\Ja{メモ \ref{memo: dichotomy}})
    \end{yoshiki}
    % See also \Cref{section: Williams--Gao--Impagliazzo's algorithm} for more details.
    } can be decided in $\mathcal{O}(n^{k - 3 + \omega})$ time \cite[Corollary 1.3]{williamsFasterDecisionFirstorder2014}\cite[Theorem 7]{gaoFineGrainedComplexityStrengthenings2019},
    where $\omega$ is the exponent of matrix multiplication.
    
    \item For some $k \ge 3$,\footnote{When $k \le 3$, it is almost clear that the "model checking problem" cannot be decided in $\mathcal{O}(n^{k-1-\varepsilon})$, as the input adjacent matrix is given by $\Theta(n^2)$ cells. See \Cref{proposition: trivial lowerbound} for a more precise proof.}
    if the "model checking problem" for $\fo^{k}$ \kl{sentences}\footnote{This claims holds even for $\fo^{k}$ \kl{sentences} in $\exists^{*} \forall$-"prenex normal form".} can be decided in $\mathcal{O}(n^{k-1-\varepsilon})$ time for some $\varepsilon > 0$,
    then the "Strong Exponential Time Hypothesis" ("SETH") is false \cite[Corollary 1.4]{williamsFasterDecisionFirstorder2014}.
\end{itemize}

However when $\fml$ is not fixed, "Williams' algorithm" \cite{williamsFasterDecisionFirstorder2014} for $\fo^{3}$ \kl{sentences} is $\mathcal{O}(2^{\len{\fml}} \cdot n^{\omega})$ time.
The exponential blowup "wrt" $\len{\fml}$ is due to that the algorithm requires a transformation to the "disjunctive normal form" ("DNF").

...

In this paper, we first revisit "Williams' algorithm".
We give a perspective from ""Tarski's calculus of relations"" (henceforth, \reintro*\kl{CoR}) \cite{tarskiCalculusRelations1941}.
\dots
We can translate $\fo^{3}$ \kl{sentences} into \kl{CoR} \kl{sentences} in $\mathcal{O}(2^{\len{\fml}})$ time.
The original translation is given in \cite{tarskiFormalizationSetTheory1987}.
An $\mathcal{O}(2^{\len{\fml}})$ time translation is given in \cite{nakamuraExpressivePowerSuccinctness2022}; an implementation of this translation is given in \cite{brogniTranslatingThreeVariableFirstOrder2025}.\footnote{"Williams' algorithm" takes almost the same steps as in the translation in \cite{nakamuraExpressivePowerSuccinctness2022}... (TODO: revise the sentences)}
For \kl{CoR} \kl{sentences}, the "model checking problem" can be decided in $\mathcal{O}(\len{\fml} \cdot n^{\omega})$ time by a naive bottom-up evaluation algorithm,
where we use the "matrix multiplication" algorithm for the "relational composition" ($\compo$).
Combining them, we have that the "model checking problem" for $\fo^{3}$ \kl{sentences} can be decided in $\mathcal{O}(2^{\len{\fml}} \cdot n^{\omega})$ time.


Now, 
...


\begin{yoshiki}
    TODO: Parameterized complexity ("eg", \cite{flumParameterizedComplexityTheory2006,flumFixedParameterTractabilityDefinability2001,flumModelCheckingProblemsBasis2005, frickComplexityFirstorderMonadic2004}).

    Parameterized complexity for space complexity \cite{chenParameterizedSpaceComplexity2019}
\end{yoshiki}